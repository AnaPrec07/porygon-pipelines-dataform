-- Train XGBoost model for monthly demand forecasting
CREATE OR REPLACE MODEL `porygon-pipelines.bigquery_models.demand_forecasting_xgboost_v4`
OPTIONS (
    MODEL_TYPE = 'BOOSTED_TREE_REGRESSOR',
    BOOSTER_TYPE = 'GBTREE',

    -- ==== M5-Inspired Parameters ====
    -- Depth and regularization to avoid overfitting large sparse retail data
    MAX_TREE_DEPTH = 8,
    MIN_TREE_CHILD_WEIGHT = 10,
    L1_REG = 0.0,
    L2_REG = 1.0,

    -- Number of trees (balanced for large datasets like 1.2M rows)
    NUM_PARALLEL_TREE = 1,

    -- Subsampling & column sampling for robustness
    SUBSAMPLE = 0.8,
    COLSAMPLE_BYTREE = 0.8,

    -- Early stopping to avoid unnecessary trees
    EARLY_STOP = TRUE,
    MAX_ITERATIONS = 500,

    -- Enable standardization for skewed retail features
    DATA_SPLIT_METHOD = 'NO_SPLIT',

    -- Feature importance
    ENABLE_GLOBAL_EXPLAIN = TRUE,

    -- Hyperparameter tuning
    HPARAM_TUNING_ALGORITHM = 'GRID_SEARCH',
    NUM_TRIALS = 30,
    HPARAM_TUNING_OBJECTIVES = ['MEDIAN_ABSOLUTE_ERROR']
)
AS
SELECT
    tgt_monthly_sales_lead_1_months AS label,
    fea_is_weekend,
    fea_is_event_1,
    fea_is_event_2,
    fea_is_sporting_event,
    fea_is_cultural_event,
    fea_is_national_event,
    fea_is_religious_event,
    fea_is_snap_ca,
    fea_is_snap_tx,
    fea_is_snap_wi,
    fea_month_sin,
    fea_ca_monthly_sales_roll_avg_3_months,
    fea_ca_monthly_sales_roll_std_3_months,
    fea_ca_monthly_sales_roll_avg_6_months,
    fea_ca_monthly_sales_roll_std_6_months,
    fea_ca_monthly_sales_roll_avg_12_months,
    fea_ca_monthly_sales_roll_std_12_months,
    fea_tx_monthly_sales_roll_avg_3_months,
    fea_tx_monthly_sales_roll_std_3_months,
    fea_tx_monthly_sales_roll_avg_6_months,
    fea_tx_monthly_sales_roll_std_6_months,
    fea_tx_monthly_sales_roll_avg_12_months,
    fea_tx_monthly_sales_roll_std_12_months,
    fea_wi_monthly_sales_roll_avg_3_months,
    fea_wi_monthly_sales_roll_std_3_months,
    fea_wi_monthly_sales_roll_avg_6_months,
    fea_wi_monthly_sales_roll_std_6_months,
    fea_wi_monthly_sales_roll_avg_12_months,
    fea_wi_monthly_sales_roll_std_12_months,
    fea_hobbies_monthly_sales_roll_avg_3_months,
    fea_hobbies_monthly_sales_roll_std_3_months,
    fea_hobbies_monthly_sales_roll_avg_6_months,
    fea_hobbies_monthly_sales_roll_std_6_months,
    fea_hobbies_monthly_sales_roll_avg_12_months,
    fea_hobbies_monthly_sales_roll_std_12_months,
    fea_household_monthly_sales_roll_avg_3_months,
    fea_household_monthly_sales_roll_std_3_months,
    fea_household_monthly_sales_roll_avg_6_months,
    fea_household_monthly_sales_roll_std_6_months,
    fea_household_monthly_sales_roll_avg_12_months,
    fea_household_monthly_sales_roll_std_12_months,
    fea_foods_monthly_sales_roll_avg_3_months,
    fea_foods_monthly_sales_roll_std_3_months,
    fea_foods_monthly_sales_roll_avg_6_months,
    fea_foods_monthly_sales_roll_std_6_months,
    fea_foods_monthly_sales_roll_avg_12_months,
    fea_foods_monthly_sales_roll_std_12_months,
    fea_hobbies_1_monthly_sales_roll_avg_3_months,
    fea_hobbies_1_monthly_sales_roll_std_3_months,
    fea_hobbies_1_monthly_sales_roll_avg_6_months,
    fea_hobbies_1_monthly_sales_roll_std_6_months,
    fea_hobbies_1_monthly_sales_roll_avg_12_months,
    fea_hobbies_1_monthly_sales_roll_std_12_months,
    fea_hobbies_2_monthly_sales_roll_avg_3_months,
    fea_hobbies_2_monthly_sales_roll_std_3_months,
    fea_hobbies_2_monthly_sales_roll_avg_6_months,
    fea_hobbies_2_monthly_sales_roll_std_6_months,
    fea_hobbies_2_monthly_sales_roll_avg_12_months,
    fea_hobbies_2_monthly_sales_roll_std_12_months,
    fea_household_1_monthly_sales_roll_avg_3_months,
    fea_household_1_monthly_sales_roll_std_3_months,
    fea_household_1_monthly_sales_roll_avg_6_months,
    fea_household_1_monthly_sales_roll_std_6_months,
    fea_household_1_monthly_sales_roll_avg_12_months,
    fea_household_1_monthly_sales_roll_std_12_months,
    fea_household_2_monthly_sales_roll_avg_3_months,
    fea_household_2_monthly_sales_roll_std_3_months,
    fea_household_2_monthly_sales_roll_avg_6_months,
    fea_household_2_monthly_sales_roll_std_6_months,
    fea_household_2_monthly_sales_roll_avg_12_months,
    fea_household_2_monthly_sales_roll_std_12_months,
    fea_foods_1_monthly_sales_roll_avg_3_months,
    fea_foods_1_monthly_sales_roll_std_3_months,
    fea_foods_1_monthly_sales_roll_avg_6_months,
    fea_foods_1_monthly_sales_roll_std_6_months,
    fea_foods_1_monthly_sales_roll_avg_12_months,
    fea_foods_1_monthly_sales_roll_std_12_months,
    fea_foods_2_monthly_sales_roll_avg_3_months,
    fea_foods_2_monthly_sales_roll_std_3_months,
    fea_foods_2_monthly_sales_roll_avg_6_months,
    fea_foods_2_monthly_sales_roll_std_6_months,
    fea_foods_2_monthly_sales_roll_avg_12_months,
    fea_foods_2_monthly_sales_roll_std_12_months,
    fea_foods_3_monthly_sales_roll_avg_3_months,
    fea_foods_3_monthly_sales_roll_std_3_months,
    fea_foods_3_monthly_sales_roll_avg_6_months,
    fea_foods_3_monthly_sales_roll_std_6_months,
    fea_foods_3_monthly_sales_roll_avg_12_months,
    fea_foods_3_monthly_sales_roll_std_12_months,
    fea_ca_1_monthly_sales_roll_avg_3_months,
    fea_ca_1_monthly_sales_roll_std_3_months,
    fea_ca_1_monthly_sales_roll_avg_6_months,
    fea_ca_1_monthly_sales_roll_std_6_months,
    fea_ca_1_monthly_sales_roll_avg_12_months,
    fea_ca_1_monthly_sales_roll_std_12_months,
    fea_ca_2_monthly_sales_roll_avg_3_months,
    fea_ca_2_monthly_sales_roll_std_3_months,
    fea_ca_2_monthly_sales_roll_avg_6_months,
    fea_ca_2_monthly_sales_roll_std_6_months,
    fea_ca_2_monthly_sales_roll_avg_12_months,
    fea_ca_2_monthly_sales_roll_std_12_months,
    fea_ca_3_monthly_sales_roll_avg_3_months,
    fea_ca_3_monthly_sales_roll_std_3_months,
    fea_ca_3_monthly_sales_roll_avg_6_months,
    fea_ca_3_monthly_sales_roll_std_6_months,
    fea_ca_3_monthly_sales_roll_avg_12_months,
    fea_ca_3_monthly_sales_roll_std_12_months,
    fea_ca_4_monthly_sales_roll_avg_3_months,
    fea_ca_4_monthly_sales_roll_std_3_months,
    fea_ca_4_monthly_sales_roll_avg_6_months,
    fea_ca_4_monthly_sales_roll_std_6_months,
    fea_ca_4_monthly_sales_roll_avg_12_months,
    fea_ca_4_monthly_sales_roll_std_12_months,
    fea_tx_1_monthly_sales_roll_avg_3_months,
    fea_tx_1_monthly_sales_roll_std_3_months,
    fea_tx_1_monthly_sales_roll_avg_6_months,
    fea_tx_1_monthly_sales_roll_std_6_months,
    fea_tx_1_monthly_sales_roll_avg_12_months,
    fea_tx_1_monthly_sales_roll_std_12_months,
    fea_tx_2_monthly_sales_roll_avg_3_months,
    fea_tx_2_monthly_sales_roll_std_3_months,
    fea_tx_2_monthly_sales_roll_avg_6_months,
    fea_tx_2_monthly_sales_roll_std_6_months,
    fea_tx_2_monthly_sales_roll_avg_12_months,
    fea_tx_2_monthly_sales_roll_std_12_months,
    fea_tx_3_monthly_sales_roll_avg_3_months,
    fea_tx_3_monthly_sales_roll_std_3_months,
    fea_tx_3_monthly_sales_roll_avg_6_months,
    fea_tx_3_monthly_sales_roll_std_6_months,
    fea_tx_3_monthly_sales_roll_avg_12_months,
    fea_tx_3_monthly_sales_roll_std_12_months,
    fea_wi_1_monthly_sales_roll_avg_3_months,
    fea_wi_1_monthly_sales_roll_std_3_months,
    fea_wi_1_monthly_sales_roll_avg_6_months,
    fea_wi_1_monthly_sales_roll_std_6_months,
    fea_wi_1_monthly_sales_roll_avg_12_months,
    fea_wi_1_monthly_sales_roll_std_12_months,
    fea_wi_2_monthly_sales_roll_avg_3_months,
    fea_wi_2_monthly_sales_roll_std_3_months,
    fea_wi_2_monthly_sales_roll_avg_6_months,
    fea_wi_2_monthly_sales_roll_std_6_months,
    fea_wi_2_monthly_sales_roll_avg_12_months,
    fea_wi_2_monthly_sales_roll_std_12_months,
    fea_wi_3_monthly_sales_roll_avg_3_months,
    fea_wi_3_monthly_sales_roll_std_3_months,
    fea_wi_3_monthly_sales_roll_avg_6_months,
    fea_wi_3_monthly_sales_roll_std_6_months,
    fea_wi_3_monthly_sales_roll_avg_12_months,
    fea_wi_3_monthly_sales_roll_std_12_months,
    fea_item_price_avg,
    fea_item_price_min,
    fea_item_price_max,
    fea_item_price_std,
    fea_store_price_avg,
    fea_store_price_min,
    fea_store_price_max,
    fea_store_price_std,
    fea_store_unique_items,
    fea_state_price_avg,
    fea_state_price_min,
    fea_state_price_max,
    fea_state_price_std,
    fea_dept_price_avg,
    fea_dept_price_min,
    fea_dept_price_max,
    fea_dept_price_std,
    fea_dept_unique_items,
    fea_price_change_direction_1m,
    fea_price_pct_change_1m,
    fea_price_pct_change_3m,
    fea_price_pct_change_6m,
    fea_price_abs_change_1m,
    fea_price_abs_change_3m,
    fea_price_abs_change_6m,
    fea_item_vs_store_price_ratio,
    fea_item_vs_dept_price_ratio,
    fea_item_vs_state_price_ratio,
    fea_item_price_min_roll_avg_3_months,
    fea_item_price_min_roll_std_3_months,
    fea_item_price_min_roll_avg_6_months,
    fea_item_price_min_roll_std_6_months,
    fea_item_price_min_roll_avg_12_months,
    fea_item_price_min_roll_std_12_months,
    fea_item_price_max_roll_avg_3_months,
    fea_item_price_max_roll_std_3_months,
    fea_item_price_max_roll_avg_6_months,
    fea_item_price_max_roll_std_6_months,
    fea_item_price_max_roll_avg_12_months,
    fea_item_price_max_roll_std_12_months,
    fea_item_price_std_roll_avg_3_months,
    fea_item_price_std_roll_std_3_months,
    fea_item_price_std_roll_avg_6_months,
    fea_item_price_std_roll_std_6_months,
    fea_item_price_std_roll_avg_12_months,
    fea_item_price_std_roll_std_12_months,
    fea_item_price_avg_roll_avg_3_months,
    fea_item_price_avg_roll_std_3_months,
    fea_item_price_avg_roll_avg_6_months,
    fea_item_price_avg_roll_std_6_months,
    fea_item_price_avg_roll_avg_12_months,
    fea_item_price_avg_roll_std_12_months,
    fea_item_store_price_min_roll_avg_3_months,
    fea_item_store_price_min_roll_std_3_months,
    fea_item_store_price_min_roll_avg_6_months,
    fea_item_store_price_min_roll_std_6_months,
    fea_item_store_price_min_roll_avg_12_months,
    fea_item_store_price_min_roll_std_12_months,
    fea_item_store_price_max_roll_avg_3_months,
    fea_item_store_price_max_roll_std_3_months,
    fea_item_store_price_max_roll_avg_6_months,
    fea_item_store_price_max_roll_std_6_months,
    fea_item_store_price_max_roll_avg_12_months,
    fea_item_store_price_max_roll_std_12_months,
    fea_item_store_price_std_roll_avg_3_months,
    fea_item_store_price_std_roll_std_3_months,
    fea_item_store_price_std_roll_avg_6_months,
    fea_item_store_price_std_roll_std_6_months,
    fea_item_store_price_std_roll_avg_12_months,
    fea_item_store_price_std_roll_std_12_months,
    fea_item_store_price_avg_roll_avg_3_months,
    fea_item_store_price_avg_roll_std_3_months,
    fea_item_store_price_avg_roll_avg_6_months,
    fea_item_store_price_avg_roll_std_6_months,
    fea_item_store_price_avg_roll_avg_12_months,
    fea_item_store_price_avg_roll_std_12_months,
    fea_store_price_avg_roll_avg_3_months,
    fea_store_price_avg_roll_std_3_months,
    fea_store_price_avg_roll_avg_6_months,
    fea_store_price_avg_roll_std_6_months,
    fea_store_price_avg_roll_avg_12_months,
    fea_store_price_avg_roll_std_12_months,
    fea_store_price_std_roll_avg_3_months,
    fea_store_price_std_roll_std_3_months,
    fea_store_price_std_roll_avg_6_months,
    fea_store_price_std_roll_std_6_months,
    fea_store_price_std_roll_avg_12_months,
    fea_store_price_std_roll_std_12_months,
    fea_store_unique_items_roll_avg_3_months,
    fea_store_unique_items_roll_std_3_months,
    fea_store_unique_items_roll_avg_6_months,
    fea_store_unique_items_roll_std_6_months,
    fea_store_unique_items_roll_avg_12_months,
    fea_store_unique_items_roll_std_12_months,
    fea_dept_price_avg_roll_avg_3_months,
    fea_dept_price_avg_roll_std_3_months,
    fea_dept_price_avg_roll_avg_6_months,
    fea_dept_price_avg_roll_std_6_months,
    fea_dept_price_avg_roll_avg_12_months,
    fea_dept_price_avg_roll_std_12_months,
    fea_dept_price_std_roll_avg_3_months,
    fea_dept_price_std_roll_std_3_months,
    fea_dept_price_std_roll_avg_6_months,
    fea_dept_price_std_roll_std_6_months,
    fea_dept_price_std_roll_avg_12_months,
    fea_dept_price_std_roll_std_12_months,
    fea_dept_price_min_roll_avg_3_months,
    fea_dept_price_min_roll_std_3_months,
    fea_dept_price_min_roll_avg_6_months,
    fea_dept_price_min_roll_std_6_months,
    fea_dept_price_min_roll_avg_12_months,
    fea_dept_price_min_roll_std_12_months,
    fea_dept_price_max_roll_avg_3_months,
    fea_dept_price_max_roll_std_3_months,
    fea_dept_price_max_roll_avg_6_months,
    fea_dept_price_max_roll_std_6_months,
    fea_dept_price_max_roll_avg_12_months,
    fea_dept_price_max_roll_std_12_months,
    fea_dept_unique_items_roll_avg_3_months,
    fea_dept_unique_items_roll_std_3_months,
    fea_dept_unique_items_roll_avg_6_months,
    fea_dept_unique_items_roll_std_6_months,
    fea_dept_unique_items_roll_avg_12_months,
    fea_dept_unique_items_roll_std_12_months,
    fea_state_price_avg_roll_avg_3_months,
    fea_state_price_avg_roll_std_3_months,
    fea_state_price_avg_roll_avg_6_months,
    fea_state_price_avg_roll_std_6_months,
    fea_state_price_avg_roll_avg_12_months,
    fea_state_price_avg_roll_std_12_months,
    fea_state_price_std_roll_avg_3_months,
    fea_state_price_std_roll_std_3_months,
    fea_state_price_std_roll_avg_6_months,
    fea_state_price_std_roll_std_6_months,
    fea_state_price_std_roll_avg_12_months,
    fea_state_price_std_roll_std_12_months,
    fea_item_vs_store_price_ratio_roll_avg_3_months,
    fea_item_vs_store_price_ratio_roll_std_3_months,
    fea_item_vs_store_price_ratio_roll_avg_6_months,
    fea_item_vs_store_price_ratio_roll_std_6_months,
    fea_item_vs_store_price_ratio_roll_avg_12_months,
    fea_item_vs_store_price_ratio_roll_std_12_months,
    fea_item_vs_dept_price_ratio_roll_avg_3_months,
    fea_item_vs_dept_price_ratio_roll_std_3_months,
    fea_item_vs_dept_price_ratio_roll_avg_6_months,
    fea_item_vs_dept_price_ratio_roll_std_6_months,
    fea_item_vs_dept_price_ratio_roll_avg_12_months,
    fea_item_vs_dept_price_ratio_roll_std_12_months,
    fea_item_vs_state_price_ratio_roll_avg_3_months,
    fea_item_vs_state_price_ratio_roll_std_3_months,
    fea_item_vs_state_price_ratio_roll_avg_6_months,
    fea_item_vs_state_price_ratio_roll_std_6_months,
    fea_item_vs_state_price_ratio_roll_avg_12_months,
    fea_item_vs_state_price_ratio_roll_std_12_months,
    fea_item_monthly_sales,
    fea_num_days_item_is_zero_sales,
    fea_item_monthly_sales_roll_avg_3_months,
    fea_item_monthly_sales_roll_avg_6_months,
    fea_item_monthly_sales_roll_avg_12_months,
    fea_item_monthly_sales_roll_std_3_months,
    fea_item_monthly_sales_roll_std_6_months,
    fea_item_monthly_sales_roll_std_12_months,
    fea_item_monthly_sales_lag_1_months,
    fea_item_monthly_sales_lag_2_months,
    fea_item_monthly_sales_lag_3_months,
    fea_item_monthly_sales_lag_4_months,
    fea_num_days_item_is_zero_sales_roll_avg_3_months,
    fea_num_days_item_is_zero_sales_roll_avg_6_months,
    fea_num_days_item_is_zero_sales_roll_avg_12_months,
    fea_num_days_item_is_zero_sales_roll_std_3_months,
    fea_num_days_item_is_zero_sales_roll_std_6_months,
    fea_num_days_item_is_zero_sales_roll_std_12_months,
    fea_num_days_item_is_zero_sales_lag_1_months,
    fea_num_days_item_is_zero_sales_lag_2_months,
    fea_num_days_item_is_zero_sales_lag_3_months,
    fea_num_days_item_is_zero_sales_lag_4_months,
    fea_state_item_monthly_sales,
    fea_state_item_num_days_is_zero_sales,
    fea_state_item_monthly_sales_roll_avg_3_months,
    fea_state_item_monthly_sales_roll_avg_6_months,
    fea_state_item_monthly_sales_roll_avg_12_months,
    fea_state_item_monthly_sales_roll_std_3_months,
    fea_state_item_monthly_sales_roll_std_6_months,
    fea_state_item_monthly_sales_roll_std_12_months,
    fea_state_item_num_days_is_zero_sales_roll_avg_3_months,
    fea_state_item_num_days_is_zero_sales_roll_avg_6_months,
    fea_state_item_num_days_is_zero_sales_roll_avg_12_months,
    fea_state_item_num_days_is_zero_sales_roll_std_3_months,
    fea_state_item_num_days_is_zero_sales_roll_std_6_months,
    fea_state_item_num_days_is_zero_sales_roll_std_12_months,
    fea_all_item_monthly_sales,
    fea_all_item_num_days_is_zero_sales,
    fea_all_item_monthly_sales_roll_avg_3_months,
    fea_all_item_monthly_sales_roll_avg_6_months,
    fea_all_item_monthly_sales_roll_avg_12_months,
    fea_all_item_monthly_sales_roll_std_3_months,
    fea_all_item_monthly_sales_roll_std_6_months,
    fea_all_item_monthly_sales_roll_std_12_months,
    fea_state_id_encoded,
    fea_cat_id_encoded,
    fea_dept_id_encoded,
    fea_store_id_encoded,
    fea_item_id_encoded,
    fea_mean_temperature, 
    fea_mean_dewp,
    fea_mean_visib, 
    fea_mean_wdsp,
    fea_mean_prcp,
    fea_mean_temprerature_roll_3, 
    fea_mean_temprerature_roll_6, 
    fea_mean_temprerature_roll_12, 
    fea_mean_dewp_roll_3, 
    fea_mean_dewp_roll_6, 
    fea_mean_dewp_roll_12, 
    fea_mean_visib_roll_3, 
    fea_mean_visib_roll_6, 
    fea_mean_visib_roll_12, 
    fea_mean_wdsp_roll_6, 
    fea_mean_wdsp_roll_12, 
    fea_mean_prcp_roll_6, 
    fea_mean_prcp_roll_12, 
    fea_mean_sndp_roll_6, 
    fea_mean_sndp_roll_12, 
    fea_mean_tornado_funnel_cloud_roll_6, 
    fea_mean_tornado_funnel_cloud_roll_12, 
    fea_mean_thunder_roll_6, 
    fea_mean_thunder_roll_12, 
    fea_mean_snow_ice_pellets_roll_6, 
    fea_mean_snow_ice_pellets_roll_12, 
    fea_mean_rain_drizzle_roll_6, 
    fea_mean_rain_drizzle_roll_12, 
    fea_mean_fog_roll_6, 
    fea_mean_fog_roll_12,
    fea_nonfamily_households,
    fea_family_households,
    fea_total_pop,
    fea_commuters_by_public_transportation,
    fea_median_income,
    fea_income_per_capita,
    fea_vacant_housing_units,
    fea_median_rent,
    fea_percent_income_spent_on_rent,
    fea_median_age,
    fea_families_with_young_children,
    fea_commute_10_14_mins,
    fea_commute_25_29_mins,
    fea_commute_45_59_mins,
    fea_income_20000_24999,
    fea_income_40000_44999,
    fea_income_60000_74999,
    fea_income_150000_199999,
    fea_households_retirement_income,
    fea_employed_pop,
    fea_unemployed_pop,
    fea_four_more_cars,
    fea_bachelors_degree_or_higher_25_64,
    fea_gini_index,
    fea_in_school,
    fea_in_undergrad_college,
    fea_wi_unemployment_rate,
    fea_tx_unemployment_rate,
    fea_ca_unemployment_rate,
    fea_gas_price_per_gallon,
    fea_wi_unemployment_rate_roll_avg_3_months,
    fea_wi_unemployment_rate_roll_std_3_months,
    fea_wi_unemployment_rate_roll_avg_6_months,
    fea_wi_unemployment_rate_roll_std_6_months,
    fea_wi_unemployment_rate_roll_avg_12_months,
    fea_wi_unemployment_rate_roll_std_12_months,
    fea_tx_unemployment_rate_roll_avg_3_months,
    fea_tx_unemployment_rate_roll_std_3_months,
    fea_tx_unemployment_rate_roll_avg_6_months,
    fea_tx_unemployment_rate_roll_std_6_months,
    fea_tx_unemployment_rate_roll_avg_12_months,
    fea_tx_unemployment_rate_roll_std_12_months,
    fea_ca_unemployment_rate_roll_avg_3_months,
    fea_ca_unemployment_rate_roll_std_3_months,
    fea_ca_unemployment_rate_roll_avg_6_months,
    fea_ca_unemployment_rate_roll_std_6_months,
    fea_ca_unemployment_rate_roll_avg_12_months,
    fea_ca_unemployment_rate_roll_std_12_months,
    fea_gas_price_per_gallon_roll_avg_3_months,
    fea_gas_price_per_gallon_roll_std_3_months,
    fea_gas_price_per_gallon_roll_avg_6_months,
    fea_gas_price_per_gallon_roll_std_6_months,
    fea_gas_price_per_gallon_roll_avg_12_months,
    fea_gas_price_per_gallon_roll_std_12_months
FROM ${ref("training_table_v4")}
WHERE ctx_date_month < "2015-04-01";
